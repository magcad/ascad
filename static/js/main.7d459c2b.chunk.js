(this["webpackJsonpcado-web-client"]=this["webpackJsonpcado-web-client"]||[]).push([[0],{130:function(e,n,t){},144:function(e,n,t){},174:function(e,n,t){"use strict";t.r(n);var c=t(0),a=t.n(c),i=t(14),o=t.n(i),r=(t(130),t(111)),l=t(13),s=t(12),d=t(98),u=t(3),j={kind:"categoryToolbox",contents:[{kind:"category",name:"Logic",colour:"#5C81A6",contents:[{kind:"block",type:"controls_if"},{kind:"block",type:"logic_compare"}]},{kind:"category",name:"Math",colour:"#5CA65C",contents:[{kind:"block",type:"math_round"},{kind:"block",type:"math_number"}]},{kind:"category",name:"Custom",colour:"#5CA699",contents:[{kind:"block",type:"new_boundary_function"},{kind:"block",type:"return"}]}]},b=function(){var e=Object(c.useState)(""),n=Object(s.a)(e,2),t=n[0],a=n[1];return Object(u.jsx)(d.BlocklyWorkspace,{toolboxConfiguration:j,initialXml:t,onXmlChange:a,className:"fill-height",workspaceConfiguration:{grid:{spacing:20,length:3,colour:"#ccc",snap:!0}}})},O=(t(144),t(215)),h=t(229),f=t(216),p=t(210),g=t(211),m=t(176),x=t(235),v=t(224),S=t(227),C=t(214),k=t(113),y=function(e){var n=e.onFileUpload;return Object(u.jsx)(k.a,{maxFileSize:1e9,filesLimit:10,dropzoneText:"Drag and drop a STEP file here or click",onChange:function(e){null===n||void 0===n||n.apply(null,[e])}})},w=t(230),E=t(231),I=t(232),U=t(217),F=t(226),A=t(109),_={API_BASE_URL:"https://api.magman.synology.me",GENERIC_USER_KEY:1006},N=t.n(A).a.create({baseURL:_.API_BASE_URL,headers:{"Content-Type":"application/json"}}),R=Object(O.a)((function(e){return Object(h.a)({root:{margin:e.spacing(1)}})})),B=function(e){var n,t=e.onSelectedScenarioChange,a=R(),i=Object(c.useState)(null),o=Object(s.a)(i,2),r=o[0],l=o[1],d=Object(c.useState)(null),j=Object(s.a)(d,2),b=j[0],O=j[1],h=Object(c.useCallback)((function(e){O(e),null!==e&&t(e)}),[]);Object(c.useEffect)((function(){N.get("/scenarios").then((function(e){if(200===e.status){var n=e.data;l(n),n.length>0&&h(n[0])}else l(null)}))}),[h]);return Object(u.jsx)("div",{className:a.root,children:Object(u.jsx)(p.a,{container:!0,direction:"column",justifyContent:"center",alignItems:"center",children:null===r?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(f.a,{}),Object(u.jsx)(m.a,{children:"Loading scenarios..."})]}):Object(u.jsxs)(w.a,{component:"fieldset",children:[Object(u.jsx)(E.a,{component:"legend",children:"Scenarios"}),Object(u.jsx)(I.a,{name:"scenario",value:null!==(n=null===b||void 0===b?void 0:b.id)&&void 0!==n?n:-1,onChange:function(e){var n,t=Number.parseInt(e.target.value);h(null!==(n=null===r||void 0===r?void 0:r.find((function(e){return e.id===t})))&&void 0!==n?n:null)},children:null!==r&&r.map((function(e){return Object(u.jsx)(U.a,{value:e.id,control:Object(u.jsx)(F.a,{color:"primary"}),label:e.name},e.id)}))})]})})})},L=t(233),P=t(234),T=t(225),D=t(220),K=t(72),z=t(71),W=t(218),G=t(219),M=Object(O.a)((function(e){return Object(h.a)({doneAvatar:{backgroundColor:K.a[500],width:e.spacing(3),height:e.spacing(3)},errorAvatar:{backgroundColor:z.a[500],width:e.spacing(3),height:e.spacing(3)}})})),J=function(e){var n=e.file,t=e.onEnd,a=e.onValidUpload,i=M(),o=Object(c.useState)(0),r=Object(s.a)(o,2),l=r[0],d=r[1],j=Object(c.useState)(!1),b=Object(s.a)(j,2),O=b[0],h=b[1],f=Object(c.useState)(null),g=Object(s.a)(f,2),x=g[0],v=g[1],S=function(e){e.stopPropagation(),d(Math.round(100*e.loaded/e.total)),e.loaded===e.total&&(h(!0),null===t||void 0===t||t.call(null))};return Object(c.useEffect)((function(){var e=new FormData;e.append("UserFK",_.GENERIC_USER_KEY.toString()),e.append("CadModelFile",n),N.post("/models",e,{onUploadProgress:S}).then((function(e){if(201!==e.status)v("".concat(e.status," ").concat(e.statusText));else{var n=e.data;null===a||void 0===a||a.call(null,n.uid)}})).catch((function(e){v(e.message)}))}),[]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(p.a,{container:!0,justifyContent:"center",direction:"row",alignItems:"center",children:Object(u.jsx)(m.a,{children:n.name})}),Object(u.jsxs)(T.a,{display:"flex",alignItems:"center",children:[Object(u.jsx)(T.a,{width:"90%",mr:1,children:Object(u.jsx)(D.a,{variant:"determinate",value:l})}),Object(u.jsx)(T.a,{minWidth:35,children:null!==x?Object(u.jsx)(L.a,{title:x,children:Object(u.jsx)(P.a,{className:i.errorAvatar,children:Object(u.jsx)(W.a,{})})}):O?Object(u.jsx)(P.a,{className:i.doneAvatar,children:Object(u.jsx)(G.a,{})}):Object(u.jsxs)(m.a,{children:[l," %"]})})]})]})},Y=function(e){var n=e.files,t=e.onFileUploadEnd,a=Object(c.useState)(0),i=Object(s.a)(a,2),o=i[0],r=i[1],l=Object(c.useState)([]),d=Object(s.a)(l,2),j=d[0],b=d[1],O=Object(c.useCallback)((function(){r((function(e){return e+1}))}),[]),h=function(e){b((function(n){var t=n.slice();return t.push(e),t}))};return Object(c.useEffect)((function(){j.length>=n.length&&(null===t||void 0===t||t.call(null,j))}),[o,j]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(m.a,{children:o===n.length?"Upload done !":"Uploading files... (".concat(o,"/").concat(n.length,")")}),n.map((function(e,n){return Object(u.jsx)(J,{file:e,onEnd:O,onValidUpload:h},n)}))]})},H=t(228),V=t(221),X=t(223),q=t(222);var Q=function(e,n){var t=Object(c.useRef)(e);Object(c.useEffect)((function(){t.current=e}),[e]),Object(c.useEffect)((function(){if(null!==n){var e=setInterval((function(){return t.current()}),n);return function(){return clearInterval(e)}}}),[n])},Z=Object(O.a)((function(e){return Object(h.a)({downloadButton:{margin:e.spacing(1)},logAccordion:{wordWrap:"break-word",whiteSpace:"pre-wrap",wordBreak:"break-all"}})})),$=function(e){var n,t=e.modelUid,a=e.scenario,i=Z(),o=Object(c.useState)(null),r=Object(s.a)(o,2),l=r[0],d=r[1],j=Object(c.useState)(null),b=Object(s.a)(j,2),O=b[0],h=b[1],f=Object(c.useState)(!1),g=Object(s.a)(f,2),x=g[0],v=g[1];return Q((function(){var e;N.get("/processes/".concat(null!==(e=null===l||void 0===l?void 0:l.uid)&&void 0!==e?e:0)).then((function(e){h(e.data),2==(null===O||void 0===O?void 0:O.status)&&v(!0)}))}),null===l||x?null:1e3),Object(c.useEffect)((function(){var e=new FormData;e.append("modelInUid",t.toString()),e.append("scenarioFK",a.id.toString()),e.append("userFK",_.GENERIC_USER_KEY.toString()),N.post("/processes",JSON.stringify(Object.fromEntries(e))).then((function(e){201!==e.status||d(e.data)})).catch((function(){}))}),[]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)(p.a,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",children:[Object(u.jsx)(p.a,{item:!0,children:Object(u.jsxs)(m.a,{children:["Processing model #",t," with scenario ",a.name]})}),Object(u.jsx)(p.a,{item:!0,children:Object(u.jsx)(C.a,{className:i.downloadButton,onClick:function(){if(null!==O){var e="".concat(_.API_BASE_URL,"/models/download/").concat(O.modelOutUid),n=document.createElement("a");n.href=e,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},variant:"contained",color:"primary",size:"large",disabled:!x,children:x?"Download":"Processing..."})})]}),Object(u.jsxs)(H.a,{children:[Object(u.jsx)(V.a,{expandIcon:Object(u.jsx)(q.a,{}),id:t.toString(),children:"See Log"}),Object(u.jsx)(X.a,{children:Object(u.jsx)("pre",{className:i.logAccordion,children:Object(u.jsx)("code",{children:null!==(n=null===O||void 0===O?void 0:O.log.replace(/\r/g,"\n"))&&void 0!==n?n:"..."})})})]})]})},ee=function(e){var n=e.scenario,t=e.modelIds;return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(m.a,{children:"Processes :"}),t.map((function(e,t){return Object(u.jsx)($,{modelUid:e,scenario:n},t)}))]})},ne=function(e){var n=e.files,t=e.scenario,a=Object(c.useState)(null),i=Object(s.a)(a,2),o=i[0],r=i[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(Y,{files:n,onFileUploadEnd:function(e){r(e)}}),null!==o&&o.length===n.length?Object(u.jsx)(ee,{scenario:t,modelIds:o}):null]})},te=Object(O.a)((function(e){return Object(h.a)({paper:{width:"50%",minWidth:"50rem",padding:e.spacing(2)},steps:{width:"90%"},contentContainer:{minHeight:"20rem",minWidth:"50rem"},backButton:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}})})),ce=function(){var e=te(),n=Object(c.useState)(0),t=Object(s.a)(n,2),a=t[0],i=t[1],o=Object(c.useState)(null),r=Object(s.a)(o,2),l=r[0],d=r[1],j=Object(c.useState)(null),b=Object(s.a)(j,2),O=b[0],h=b[1],k=["Select CAD file(s)","Choose scenario","Get your files"],w=function(e){d(e)},E=function(e){h(e)};return Object(u.jsx)(p.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:Object(u.jsxs)(g.a,{className:e.paper,children:[Object(u.jsxs)(p.a,{container:!0,direction:"column",alignItems:"center",justifyContent:"center",children:[Object(u.jsx)(m.a,{variant:"h4",children:"ASCAD"}),Object(u.jsx)(m.a,{variant:"h6",children:"Simplify and Convert"}),Object(u.jsx)(x.a,{className:e.steps,activeStep:a,alternativeLabel:!0,children:k.map((function(e){return Object(u.jsx)(v.a,{children:Object(u.jsx)(S.a,{children:e})},e)}))}),Object(u.jsx)("div",{className:e.contentContainer,children:function(e){switch(e){case 0:return Object(u.jsxs)("div",{children:[Object(u.jsx)(y,{onFileUpload:w}),Object(u.jsx)("ul",{children:null!==l&&l.map((function(e,n){return Object(u.jsx)("li",{children:e.name},n)}))})]});case 1:return Object(u.jsx)(B,{onSelectedScenarioChange:E});case 2:return null!==l&&null!==O?Object(u.jsx)(ne,{files:l,scenario:O}):Object(u.jsx)(f.a,{});default:return Object(u.jsx)("div",{children:"Unknown stepIndex"})}}(a)})]}),Object(u.jsx)(p.a,{container:!0,direction:"row",justifyContent:"flex-end",alignItems:"center",children:a===k.length?Object(u.jsx)(C.a,{onClick:function(){i(0)},size:"large",children:"Restart"}):a!==k.length-1?Object(u.jsx)("div",{children:Object(u.jsx)(C.a,{variant:"contained",color:"primary",size:"large",onClick:function(){i((function(e){return e+1}))},disabled:!function(){switch(a){case 0:return null!==l&&l.length>0;case 1:return null!==O;default:return!1}}(),children:"Next"})}):null})]})})};var ae=function(){return Object(u.jsx)(r.a,{children:Object(u.jsxs)(l.c,{children:[Object(u.jsx)(l.a,{exact:!0,path:"/",component:ce}),Object(u.jsx)(l.a,{exact:!0,path:"/scenario-editor",component:b}),Object(u.jsx)(l.a,{children:"404"})]})})},ie=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,237)).then((function(n){var t=n.getCLS,c=n.getFID,a=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),c(e),a(e),i(e),o(e)}))};o.a.render(Object(u.jsx)(a.a.StrictMode,{children:Object(u.jsx)(ae,{})}),document.getElementById("root")),ie()}},[[174,1,2]]]);
//# sourceMappingURL=main.7d459c2b.chunk.js.map