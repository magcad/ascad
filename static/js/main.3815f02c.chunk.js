(this["webpackJsonpcado-web-client"]=this["webpackJsonpcado-web-client"]||[]).push([[0],{118:function(e,n,t){},119:function(e,n,t){},152:function(e,n,t){"use strict";t.r(n);var c=t(0),a=t.n(c),i=t(12),r=t.n(i),l=(t(118),t(13)),o=(t(119),t(193)),s=t(207),d=t(194),u=t(188),j=t(189),b=t(154),O=t(213),h=t(202),f=t(205),g=t(192),m=t(101),p=t(4),x=function(e){var n=e.onFileUpload;return Object(p.jsx)(m.a,{maxFileSize:1e9,filesLimit:10,dropzoneText:"Drag and drop a STEP file here or click",onChange:function(e){null===n||void 0===n||n.apply(null,[e])}})},v=t(208),S=t(209),C=t(210),w=t(195),E=t(204),I=t(99),U={API_BASE_URL:"https://magman.synology.me:4430/api",GENERIC_USER_KEY:1006},y=t.n(I).a.create({baseURL:U.API_BASE_URL,headers:{"Content-Type":"application/json"}}),F=Object(o.a)((function(e){return Object(s.a)({root:{margin:e.spacing(1)}})})),k=function(e){var n,t=e.onSelectedScenarioChange,a=F(),i=Object(c.useState)(null),r=Object(l.a)(i,2),o=r[0],s=r[1],j=Object(c.useState)(null),O=Object(l.a)(j,2),h=O[0],f=O[1],g=Object(c.useCallback)((function(e){f(e),null!==e&&t(e)}),[]);Object(c.useEffect)((function(){y.get("/scenarios").then((function(e){if(200===e.status){var n=e.data;s(n),n.length>0&&g(n[0])}else s(null)}))}),[g]);return Object(p.jsx)("div",{className:a.root,children:Object(p.jsx)(u.a,{container:!0,direction:"column",justifyContent:"center",alignItems:"center",children:null===o?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(d.a,{}),Object(p.jsx)(b.a,{children:"Loading scenarios..."})]}):Object(p.jsxs)(v.a,{component:"fieldset",children:[Object(p.jsx)(S.a,{component:"legend",children:"Scenarios"}),Object(p.jsx)(C.a,{name:"scenario",value:null!==(n=null===h||void 0===h?void 0:h.id)&&void 0!==n?n:-1,onChange:function(e){var n,t=Number.parseInt(e.target.value);g(null!==(n=null===o||void 0===o?void 0:o.find((function(e){return e.id===t})))&&void 0!==n?n:null)},children:null!==o&&o.map((function(e){return Object(p.jsx)(w.a,{value:e.id,control:Object(p.jsx)(E.a,{color:"primary"}),label:e.name},e.id)}))})]})})})},A=t(211),N=t(212),R=t(203),_=t(198),P=t(67),B=t(66),L=t(196),D=t(197),T=Object(o.a)((function(e){return Object(s.a)({doneAvatar:{backgroundColor:P.a[500],width:e.spacing(3),height:e.spacing(3)},errorAvatar:{backgroundColor:B.a[500],width:e.spacing(3),height:e.spacing(3)}})})),K=function(e){var n=e.file,t=e.onEnd,a=e.onValidUpload,i=T(),r=Object(c.useState)(0),o=Object(l.a)(r,2),s=o[0],d=o[1],j=Object(c.useState)(!1),O=Object(l.a)(j,2),h=O[0],f=O[1],g=Object(c.useState)(null),m=Object(l.a)(g,2),x=m[0],v=m[1],S=function(e){e.stopPropagation(),d(Math.round(100*e.loaded/e.total)),e.loaded===e.total&&(f(!0),null===t||void 0===t||t.call(null))};return Object(c.useEffect)((function(){var e=new FormData;e.append("UserFK",U.GENERIC_USER_KEY.toString()),e.append("CadModelFile",n),y.post("/models",e,{onUploadProgress:S}).then((function(e){if(201!==e.status)v("".concat(e.status," ").concat(e.statusText));else{var n=e.data;null===a||void 0===a||a.call(null,n.uid)}})).catch((function(e){v(e.message)}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(u.a,{container:!0,justifyContent:"center",direction:"row",alignItems:"center",children:Object(p.jsx)(b.a,{children:n.name})}),Object(p.jsxs)(R.a,{display:"flex",alignItems:"center",children:[Object(p.jsx)(R.a,{width:"90%",mr:1,children:Object(p.jsx)(_.a,{variant:"determinate",value:s})}),Object(p.jsx)(R.a,{minWidth:35,children:null!==x?Object(p.jsx)(A.a,{title:x,children:Object(p.jsx)(N.a,{className:i.errorAvatar,children:Object(p.jsx)(L.a,{})})}):h?Object(p.jsx)(N.a,{className:i.doneAvatar,children:Object(p.jsx)(D.a,{})}):Object(p.jsxs)(b.a,{children:[s," %"]})})]})]})},z=function(e){var n=e.files,t=e.onFileUploadEnd,a=Object(c.useState)(0),i=Object(l.a)(a,2),r=i[0],o=i[1],s=Object(c.useState)([]),d=Object(l.a)(s,2),u=d[0],j=d[1],O=Object(c.useCallback)((function(){o((function(e){return e+1}))}),[]),h=function(e){j((function(n){var t=n.slice();return t.push(e),t}))};return Object(c.useEffect)((function(){u.length>=n.length&&(null===t||void 0===t||t.call(null,u))}),[r,u]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(b.a,{children:r===n.length?"Upload done !":"Uploading files... (".concat(r,"/").concat(n.length,")")}),n.map((function(e,n){return Object(p.jsx)(K,{file:e,onEnd:O,onValidUpload:h},n)}))]})},G=t(206),W=t(199),J=t(201),M=t(200);var Y=function(e,n){var t=Object(c.useRef)(e);Object(c.useEffect)((function(){t.current=e}),[e]),Object(c.useEffect)((function(){if(null!==n){var e=setInterval((function(){return t.current()}),n);return function(){return clearInterval(e)}}}),[n])},H=Object(o.a)((function(e){return Object(s.a)({downloadButton:{margin:e.spacing(1)},logAccordion:{wordWrap:"break-word",whiteSpace:"pre-wrap",wordBreak:"break-all"}})})),V=function(e){var n,t=e.modelUid,a=e.scenario,i=H(),r=Object(c.useState)(null),o=Object(l.a)(r,2),s=o[0],d=o[1],j=Object(c.useState)(null),O=Object(l.a)(j,2),h=O[0],f=O[1],m=Object(c.useState)(!1),x=Object(l.a)(m,2),v=x[0],S=x[1];return Y((function(){var e;y.get("/processes/".concat(null!==(e=null===s||void 0===s?void 0:s.uid)&&void 0!==e?e:0)).then((function(e){f(e.data),2==(null===h||void 0===h?void 0:h.status)&&S(!0)}))}),null===s||v?null:1e3),Object(c.useEffect)((function(){var e=new FormData;e.append("modelInUid",t.toString()),e.append("scenarioFK",a.id.toString()),e.append("userFK",U.GENERIC_USER_KEY.toString()),y.post("/processes",JSON.stringify(Object.fromEntries(e))).then((function(e){201!==e.status||d(e.data)})).catch((function(){}))}),[]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(u.a,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",children:[Object(p.jsx)(u.a,{item:!0,children:Object(p.jsxs)(b.a,{children:["Processing model #",t," with scenario ",a.name]})}),Object(p.jsx)(u.a,{item:!0,children:Object(p.jsx)(g.a,{className:i.downloadButton,onClick:function(){if(null!==h){var e="".concat(U.API_BASE_URL,"/models/download/").concat(h.modelOutUid),n=document.createElement("a");n.href=e,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}},variant:"contained",color:"primary",size:"large",disabled:!v,children:v?"Download":"Processing..."})})]}),Object(p.jsxs)(G.a,{children:[Object(p.jsx)(W.a,{expandIcon:Object(p.jsx)(M.a,{}),id:t.toString(),children:"See Log"}),Object(p.jsx)(J.a,{children:Object(p.jsx)("pre",{className:i.logAccordion,children:Object(p.jsx)("code",{children:null!==(n=null===h||void 0===h?void 0:h.log.replace(/\r/g,"\n"))&&void 0!==n?n:"..."})})})]})]})},q=function(e){var n=e.scenario,t=e.modelIds;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(b.a,{children:"Processes :"}),t.map((function(e,t){return Object(p.jsx)(V,{modelUid:e,scenario:n},t)}))]})},Q=function(e){var n=e.files,t=e.scenario,a=Object(c.useState)(null),i=Object(l.a)(a,2),r=i[0],o=i[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(z,{files:n,onFileUploadEnd:function(e){o(e)}}),null!==r&&r.length===n.length?Object(p.jsx)(q,{scenario:t,modelIds:r}):null]})},X=Object(o.a)((function(e){return Object(s.a)({paper:{width:"50%",minWidth:"50rem",padding:e.spacing(2)},steps:{width:"90%"},contentContainer:{minHeight:"20rem",minWidth:"50rem"},backButton:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}})}));var Z=function(){var e=X(),n=Object(c.useState)(0),t=Object(l.a)(n,2),a=t[0],i=t[1],r=Object(c.useState)(null),o=Object(l.a)(r,2),s=o[0],m=o[1],v=Object(c.useState)(null),S=Object(l.a)(v,2),C=S[0],w=S[1],E=["Select CAD file(s)","Choose scenario","Get your files"],I=function(e){m(e)},U=function(e){w(e)};return Object(p.jsx)(u.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justifyContent:"center",style:{minHeight:"100vh"},children:Object(p.jsxs)(j.a,{className:e.paper,children:[Object(p.jsxs)(u.a,{container:!0,direction:"column",alignItems:"center",justifyContent:"center",children:[Object(p.jsx)(b.a,{variant:"h4",children:"ASCAD"}),Object(p.jsx)(b.a,{variant:"h6",children:"Simplify and Convert"}),Object(p.jsx)(O.a,{className:e.steps,activeStep:a,alternativeLabel:!0,children:E.map((function(e){return Object(p.jsx)(h.a,{children:Object(p.jsx)(f.a,{children:e})},e)}))}),Object(p.jsx)("div",{className:e.contentContainer,children:function(e){switch(e){case 0:return Object(p.jsxs)("div",{children:[Object(p.jsx)(x,{onFileUpload:I}),Object(p.jsx)("ul",{children:null!==s&&s.map((function(e,n){return Object(p.jsx)("li",{children:e.name},n)}))})]});case 1:return Object(p.jsx)(k,{onSelectedScenarioChange:U});case 2:return null!==s&&null!==C?Object(p.jsx)(Q,{files:s,scenario:C}):Object(p.jsx)(d.a,{});default:return Object(p.jsx)("div",{children:"Unknown stepIndex"})}}(a)})]}),Object(p.jsx)(u.a,{container:!0,direction:"row",justifyContent:"flex-end",alignItems:"center",children:a===E.length?Object(p.jsx)(g.a,{onClick:function(){i(0)},size:"large",children:"Restart"}):a!==E.length-1?Object(p.jsx)("div",{children:Object(p.jsx)(g.a,{variant:"contained",color:"primary",size:"large",onClick:function(){i((function(e){return e+1}))},disabled:!function(){switch(a){case 0:return null!==s&&s.length>0;case 1:return null!==C;default:return!1}}(),children:"Next"})}):null})]})})},$=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,215)).then((function(n){var t=n.getCLS,c=n.getFID,a=n.getFCP,i=n.getLCP,r=n.getTTFB;t(e),c(e),a(e),i(e),r(e)}))};r.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(Z,{})}),document.getElementById("root")),$()}},[[152,1,2]]]);
//# sourceMappingURL=main.3815f02c.chunk.js.map